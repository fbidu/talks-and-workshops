<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="keywords" content="api, python, django, rest, fbidu" />
    <meta name="description" content="Slides for a workshop on REST APIs" />
    <title>Arquitetura, Especifica√ß√£o e Implementa√ß√£o de APIs REST</title>
    <style>
        @import 'https://fonts.googleapis.com/css?family=Lobster|Kelly+Slab|Raleway|Roboto+Mono';
        .vintage
        {
            background: #425454;
            color: #F4EEB4;
            font-family: 'Raleway', sans-serif;
            line-height: 2em;
            font-size: 1.5em;
        }

        .splash h1{
            font-family: 'Lobster', cursive; !important;
        }

      .vintage h1, .vintage h2{
          color: #ABC39F;
          line-height: 1.3em;
          font-size: 0.5em;
          font-family: 'Kelly Slab';
      }

      .vintage h3
      {
          font-family: 'Raleway', sans-serif;
          font-size: 0.8em;
          line-height: 1em;
      }

      .vintage a {
          color: #55897D;
          text-decoration: none;
      }
      code {
        background: #e7e8e2;
        border-radius: 5px;
        line-height: 1.5em;
      }
      .remark-code, .remark-inline-code { font-family: 'Roboto Mono'; }
      .remark-code-line-highlighted     { background-color: #373832; }
      h1, h2, h3 {
        font-family: 'Yanone Kaffeesatz';
        font-weight: 400;
        margin-bottom: 0;
      }
      .remark-slide-content h1 { font-size: 3em; }
      .remark-slide-content h2 { font-size: 2em; }
      .remark-slide-content h3 { font-size: 1.6em; }
      .footnote {
        position: absolute;
        bottom: 3em;
      }
      li p { line-height: 1.25em; }
      .red { color: #fa0000; }
      .large { font-size: 2em; }

      .pull-left {
        float: left;
        width: 47%;
      }
      .pull-right {
        float: right;
        width: 47%;
      }
      .pull-right ~ p {
        clear: both;
      }
      #slideshow .slide .content code {
        font-size: 0.8em;
      }
      #slideshow .slide .content pre code {
        font-size: 0.9em;
        padding: 15px;
      }

    </style>
  </head>
  <body>
    <textarea id="source">
class: center, middle, vintage, splash
# Arquitetura, Especifica√ß√£o e Implementa√ß√£o de APIs REST
### por [Felipe Videira](https://felipevr.com)
---
class: middle, vintage
# Agenda

* API? REST?? ‚Äî Motiva√ß√£o
* GET &amp; 404 ‚Äî Verbos e c√≥digos HTTP
* JSON &amp; YAML ‚Äî Comunica√ß√£o
* OAUTH &amp; JWT ‚Äî Autentica√ß√£o
* Blueprint &amp; Swagger ‚Äî Documenta√ß√£o
* Django, Flask &amp; *Pythonicidade* ‚Äî Implementa√ß√£o
* Py.test, doctest &amp; unittest ‚Äî Testando seu c√≥digo
* Heroku, EC2, EBS, Lambda ‚Äî Colocando seu c√≥digo no ar
* AB ‚Äî Teste de carga
---
class: center, middle, vintage
# API? REST??
### Motiva√ß√£o
---
class: vintage
# API
- Um conjunto de estruturas, opera√ß√µes, protocolos e ferramentas para constru√ß√£o de software
- Uma API define um *contrato*, um pacto entre o usu√°rio da API e o programador
- Permite que outros programas fa√ßam uso das suas caracter√≠sticas
---
class: vintage
## Uma Cafeteira
- Faz *s√≥ um trabalho* - caf√©
- Exige o *m√≠nimo necess√°rio* - √°gua, p√≥ de caf√© e energia
- Depois de alimentada com o input necess√°rio, faz o trabalho
- Entrega o *resultado esperado*. Nem mais, nem menos
---
class: vintage
## E uma cafeteira *com API?*
- De alguma forma m√°gica n√≥s automatizamos nossa cafeteira e ensinamos Python para ela
```python
import cafeteira
cafeteira.fa√ßa_caf√©()  # Python 3 ‚ù§
```
- Agora n√≥s temos *acesso program√°tico* para nossa cafeteira
- Podemos utilizar sua funcionalidade *em nossos c√≥digos!*
---
class: vintage, middle
```python
# 8h da manh√£, hora do caf√©!
if hora_atual == 8:
    cafeteira.fa√ßa_caf√©()
```
```python
# Eu n√£o gosto de n√∫meros √≠mpares, vou fazer um caf√© pra relaxar
if n % 2:
    cafeteira.fa√ßa_caf√©()
```
---
class: vintage
# APIs Web
- Permitem que a gente fa√ßa acesso a **recursos remotos**
- Podemos utilizar de funcionalidades **j√° existentes** em outros servi√ßos dispon√≠veis na Internet
- Tornam a Internet **program√°vel**
---
class: vintage
## Exemplos
- placekitten ‚Äî Retorna imagens de gatinhos, nas dimens√µes pedidas [`http://placekitten.com/800/600`](http://placekitten.com/800/600)
- ipify ‚Äî Retorna o seu endere√ßo de IP na Internet [`https://api.ipify.org/`](https://api.ipify.org/)
- mathjs ‚Äî Faz c√°lculos matem√°ticos [`http://api.mathjs.org/v1/?expr=2*7`](http://api.mathjs.org/v1/?expr=2*7)
---
class: vintage
## Exemplos
- [APIs do Twitter](https://dev.twitter.com/rest/public) ‚Äî Permitem que voc√™ interaja com o servi√ßo de forma bastante ampla - poste novos tweets, busque por tweets, etc
- [Facebook Graph API](https://developers.facebook.com/docs/graph-api) ‚Äî Analogamente √† API do Twitter, permite que voc√™ execute a√ß√µes dentro do Facebok diretamente do seu c√≥digo - Publique status, fa√ßa upload de imagens, determine se duas pessoas s√£o amigos, liste os eventos que a pessoa foi convidada, etc
---
class: vintage, middle, center
# REST
*Representational State Transfer* ‚Äî Transfer√™ncia de Estado de Representa√ß√£o
---
class: vintage, middle, center
# Hein?
---
class: vintage
## REST
- √â o **padr√£o desej√°vel** de **arquitetura da Internet**
- Define uma s√©rie de regras que os componentes de um **sistema Web ideal** devem seguir
- Ao seguir estas regras, o sistema ganha diversas vantagens como **simplicidade**, **escalabilidade**,
**portabilidade**, **estabilidade**
---
class: vintage
## REST
- Define 5 elementos b√°sicos
1. Recurso
2. Identificador de Recurso
3. Representa√ß√£o
4. Metadados da Representa√ß√£o
5. Dados de Controle
---
class: vintage
## REST
### Recursos e Identificadores de Recurso
- **Qualquer informa√ß√£o nome√°vel** pode ser considerado um "recurso" -
uma imagem, um documento, uma pessoa, um servi√ßo, uma cole√ß√£o de outros recursos
- O Identificador de Recurso √© uma informa√ß√£o - por exemplo um nome - que √© **mapeado para o recurso em si**
- Por mais que o Recurso em si possa **mudar ao longo do tempo**, o Identificador **sempre** aponta para ele
---
class: vintage
## REST
### Recursos e Identificadores de Recurso
- **Identificador** ‚Äî Presidente dos EUA
- **Recurso** ‚Äî Barack Obama
- Ano que vem, esse Identificador n√£o apontar√° mais para *Barack Obama* mas
ainda apontar√° para seja l√° quem for o presidente
---
class: vintage
## REST
### Recursos e Identificadores de Recurso
- **Identificador** ‚Äî Tony Ramos
- **Recurso** ‚Äî Tony Ramos
- Este Identificador sempre ir√° mapear para a mesma pessoa
---
class: vintage
## REST
### Recursos e Identificadores de Recurso
- **Identificador** ‚Äî Pa√≠ses que s√£o membros da Uni√£o Europeia
- **Recurso** ‚Äî [Fran√ßa, Alemanha, It√°lia, Espanha...]
- Este Identificador aponta para uma lista de Recursos. Quando a Inglaterra
completar sua sa√≠da da UE, a lista mudar√° mas o Identificador continuar√°
apontando para o lugar certo
---
class: vintage
## REST
### Recursos e Identificadores de Recurso
- **Identificador** ‚Äî [`http://ecorp.com/financeiro/relatorio_atual`](http://ecorp.com/financeiro/relatorio_atual)
- **Recurso** ‚Äî O relat√≥rio financeiro do ano atual
- Independente do ano em que estamos, obteremos o relat√≥rio corrente
---
class: vintage
## REST
### Recursos e Identificadores de Recurso
- **Identificador** ‚Äî [`http://ecorp.com/financeiro/relatorio_2010`](http://ecorp.com/financeiro/relatorio_2010)
- **Recurso** ‚Äî O relat√≥rio financeiro do ano de 2010
- Sempre obteremos o relat√≥rio de 2010
---
class: vintage
## REST
### Recursos e Identificadores de Recurso
- Seja l√° quem nomeou o Recurso √© respons√°vel por garantir o mapeamento entre o
Identificador e o Recurso em si!
- Falhas neste mapeamento pode levar a inconsist√™ncias e a erros, como o famoso
erro **404 N√£o Encontrado**, onde um Identificador n√£o √© mapeado para recurso algum
---
class: vintage
## REST
### Representa√ß√µes de Recursos
- √â uma captura do estado atual ou desejado de um Recurso
---
class: vintage
## REST
### Representa√ß√µes de Recursos
- **Identificador** ‚Äî Logo do Python
-  **Representa√ß√£o**:

![python logo](img/python-logo.png)
---
class: vintage
## REST
### Representa√ß√µes de Recursos
- **Identificador** ‚Äî Logo do Python em Preto
-  **Representa√ß√£o**:

![python logo black](img/python-logo-black.png)
---
class: vintage
## REST
### Metadados da Representa√ß√£o
- S√£o informa√ß√µes que qualificam a Representa√ß√£o oferecida
- Deve ser apresentado em pares de chaves e valores, como num dicion√°rio
- Podem incluir informa√ß√µes como o formato da representa√ß√£o, o tamanho, etc
---
class: vintage
## REST
### Metadados da Representa√ß√£o
.pull-left[
-  **Representa√ß√£o**:

![python logo](img/python-logo.png)
]
.pull-right[
- **Metadados**:
```python
    'tipo': 'PNG',
    'tamanho': '8.6kB'
```
]
---
class: vintage
## REST
### Dados de Controle
- Modificam o comportamento
- Tamb√©m podemos oferecer dados que permitem ao cliente determinar a 'validade'
daquela representa√ß√£o
- Dessa forma o cliente pode fazer um *caching* local do recurso e possivelmente
economizar recursos computacionais se for pedir pelo mesmo recurso mais de uma vez
---
class: vintage
## REST
### Dados de Controle
.pull-left[
- **Identificador:** Foto do presidente dos EUA
- **Representa√ß√£o**:

![presidente dos EUA](img/obama.jpg)
]
.pull-right[
- **Metadados**:
```python
    'tipo': 'JPG',
    'tamanho': '13.5kB',
    'validade': '20/01/2017'
```
]
---
class: vintage
## REST
### Metadados de Controle ‚Äî Cacheamento
- O cliente guarda a representa√ß√£o at√© a data especificada
- Caso queira acessar esse recurso novamente, verifica se o conte√∫do j√° 'venceu'
- Se o conte√∫do ainda √© v√°lido, o cliente economiza recursos pois pode utilizar
a representa√ß√£o armazenada ao inv√©s de pedir uma nova
---
class: vintage, middle, center
# GET &amp; 404
### Verbos e c√≥digos HTTP
---
class: vintage
## Protocolo HTTP
### Origem e import√¢ncia
---
class: vintage
## Protocolo HTTP
### Verbos
---
class: vintage
## Protocolo HTTP
### C√≥digos de Status
---
class: vintage
## Protocolo HTTP
### Cabe√ßalhos
---
class: vintage
## Protocolo HTTP
### Negocia√ß√£o de Conte√∫do
---
class: vintage, middle, center
# JSON &amp; YAML
### Comunica√ß√£o
---
class: vintage
## JSON &amp; YAML
### Papo de m√°quina e papo de gente
---
class: vintage
## JSON &amp; YAML
### Serializa√ß√£o e desserializa√ß√£o
---
class: vintage
## JSON &amp; YAML
### XML?
---
class: vintage, middle, center
# OAUTH &amp; JWT
### Autentica√ß√£o
---
class: vintage
## OAUTH &amp; JWT
### Autentica√ß√£o vs Autoriza√ß√£o
---
class: vintage
## OAUTH &amp; JWT
### Tokens e seguran√ßa
---
class: vintage
## OAUTH &amp; JWT
### OAUTH e OAUTH2
---
class: vintage
## OAUTH &amp; JWT
### JWT
---
class: vintage
## OAUTH &amp; JWT
### Outros m√©todos
---
class: vintage
## OAUTH &amp; JWT
### Man in the Cloud?
---
class: vintage
## OAUTH &amp; JWT
### HTTPS
---
class: vintage, middle, center
# Blueprint &amp; Swagger
### Documenta√ß√£o
---
class: vintage
## Blueprint &amp; Swagger
### Documente uma vez, atualize primeiro.
---
class: vintage
## Blueprint &amp; Swagger
### Mock Servers ou *como tirar o time de front-end do seu p√©?*
---
class: vintage, middle, center
# Django, Flask &amp; *Pythonicidade*
### Implementa√ß√£o
---
class: vintage
## Django, Flask &amp; *Pythonicidade*
### Zen do Python e REST
---
class: vintage
## Django, Flask &amp; *Pythonicidade*
### Microframeworks, macroframeworks
---
class: vintage
## Django, Flask &amp; *Pythonicidade*
### Projeto exemplo?
---
class: vintage
## Django, Flask &amp; *Pythonicidade*
### Django REST Framework
---
class: vintage
## Django, Flask &amp; *Pythonicidade*
### Django OAUTH Toolkit
---
class: vintage, middle, center
# Py.test, doctest &amp; unittest
### Testando seu c√≥digo
---
class: vintage
## Py.test, doctest &amp; unittest
### Testar pra qu√™?
---
class: vintage
## Py.test, doctest &amp; unittest
### Testes unit√°rios e testes de integra√ß√£o
---
class: vintage
## Py.test, doctest &amp; unittest
### E os bancos de dados?
---
class: vintage, middle, center
# Heroku, EC2, EBS, Lambda
### Colocando seu c√≥digo no ar
---
class: vintage
## Heroku, EC2, EBS, Lambda
### Cloud, PaaS, SaaS e outros nomes pra impressionar a galera
---
class: vintage
## Heroku, EC2, EBS, Lambda
### Heroku
---
class: vintage
## Heroku, EC2, EBS, Lambda
### EC2/DigitalOcean
---
class: vintage
## Heroku, EC2, EBS, Lambda
### EBS
---
class: vintage
## Heroku, EC2, EBS, Lambda
### Lambda
---
class: vintage, middle, center
# AB
### Teste de carga
---
class: vintage
## AB
### Centenas de requests simult√¢neos!
---
class: vintage, middle, center
# Fontes
---
class: vintage
- [**Architectural Styles and the Design of Network-based Software Architectures**](http://www.ics.uci.edu/~fielding/pubs/dissertation/fielding_dissertation.pdf)
---
class: vintage, middle, center
# Obrigado üòÑ
</textarea>
<script src="http://gnab.github.io/remark/downloads/remark-latest.min.js" type="text/javascript"></script>
<script>
  var hljs = remark.highlighter.engine;
</script>
<script src="remark.language.js"></script>
<script>
  var slideshow = remark.create({
      highlightStyle: 'monokai',
      highlightLanguage: 'remark',
      highlightLines: true
    }) ;
</script>
</body>
</html>

<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="keywords" content="api, python, django, rest, fbidu" />
    <meta name="description" content="Slides for a workshop on REST APIs" />
    <title>Arquitetura, Especificação e Implementação de APIs REST</title>
    <style>
        @import 'https://fonts.googleapis.com/css?family=Lobster|Kelly+Slab|Raleway|Roboto+Mono';
        .vintage
        {
            background: #425454;
            color: #F4EEB4;
            font-family: 'Raleway', sans-serif;
            line-height: 2em;
            font-size: 1.5em;
        }

        .splash h1{
            font-family: 'Lobster', cursive; !important;
        }

      .vintage h1, .vintage h2{
          color: #ABC39F;
          line-height: 1.3em;
          font-size: 0.5em;
          font-family: 'Kelly Slab';
      }

      .vintage h3
      {
          font-family: 'Raleway', sans-serif;
          font-size: 0.8em;
          line-height: 1em;
      }

      .vintage a {
          color: #55897D;
          text-decoration: none;
      }
      code {
        background: #e7e8e2;
        border-radius: 5px;
        line-height: 1.5em;
      }
      .remark-code, .remark-inline-code { font-family: 'Roboto Mono'; }
      .remark-code-line-highlighted     { background-color: #373832; }
      h1, h2, h3 {
        font-family: 'Yanone Kaffeesatz';
        font-weight: 400;
        margin-bottom: 0;
      }
      .remark-slide-content h1 { font-size: 3em; }
      .remark-slide-content h2 { font-size: 2em; }
      .remark-slide-content h3 { font-size: 1.6em; }
      .footnote {
        position: absolute;
        bottom: 3em;
      }
      li p { line-height: 1.25em; }
      .red { color: #fa0000; }
      .large { font-size: 2em; }

      .pull-left {
        float: left;
        width: 47%;
      }
      .pull-right {
        float: right;
        width: 47%;
      }
      .pull-right ~ p {
        clear: both;
      }
      #slideshow .slide .content code {
        font-size: 0.8em;
      }
      #slideshow .slide .content pre code {
        font-size: 0.9em;
        padding: 15px;
      }

    </style>
  </head>
  <body>
    <textarea id="source">
class: center, middle, vintage, splash
# Arquitetura, Especificação e Implementação de APIs REST
### por [Felipe Videira](https://felipevr.com)
---
class: middle, vintage
# Agenda

* API? REST?? — Motivação
* GET &amp; 404 — Verbos e códigos HTTP
* JSON &amp; YAML — Comunicação
* OAUTH &amp; JWT — Autenticação
* Blueprint &amp; Swagger — Documentação
* Django, Flask &amp; *Pythonicidade* - Implementação
* Py.test, doctest &amp; unittest — Testando seu código
* Heroku, EC2, EBS, Lambda — Colocando seu código no ar
* AB — Teste de carga
---
class: center, middle, vintage
# API? REST??
### Motivação
---
class: vintage
# API
- Um conjunto de estruturas, operações, protocolos e ferramentas para construção de software
- Uma API define um *contrato*, um pacto entre o usuário da API e o programador
- Permite que outros programas façam uso das suas características
---
class: vintage
## Uma Cafeteira
- Faz *só um trabalho* - café
- Exige o *mínimo necessário* - água, pó de café e energia
- Depois de alimentada com o input necessário, faz o trabalho
- Entrega o *resultado esperado*. Nem mais, nem menos
---
class: vintage
## E uma cafeteira *com API*
- De alguma forma mágica nós automatizamos nossa cafeteira e ensinamos Python para ela
```python
import cafeteira
cafeteira.make_coffee()
```
- Agora nós temos *acesso programático* para nossa cafeteira
- Podemos utilizar sua funcionalidade *em nossos códigos!*
---
class: vintage, middle
```python
# 8h da manhã, hora do café!
if hora_atual == 8:
    cafeteira.make_coffee()
```
```python
# Eu não gosto de números ímpares, vou fazer um café pra relaxar
if n % 2:
    cafeteira.make_coffee()
```
---
class: vintage
# APIs Web
- Permitem que a gente faça acesso a **recursos remotos**
- Podemos utilizar de funcionalidades **já existentes** em outros serviços disponíveis na Internet
- Tornam a Internet **programável**
---
class: vintage
## Exemplos
- placekitten - Retorna imagens de gatinhos, nas dimensões pedidas [`http://placekitten.com/800/600`](http://placekitten.com/800/600)
- ipify - Retorna o seu endereço de IP na Internet [`https://api.ipify.org/`](https://api.ipify.org/)
- mathjs - Faz cálculos matemáticos [`http://api.mathjs.org/v1/?expr=2*7`](http://api.mathjs.org/v1/?expr=2*7)
---
class: vintage
## Exemplos
- [APIs do Twitter](https://dev.twitter.com/rest/public) - Permitem que você interaja com o serviço de forma bastante ampla - poste novos tweets, busque por tweets, etc
- [Facebook Graph API](https://developers.facebook.com/docs/graph-api) - Analogamente à API do Twitter, permite que você execute ações dentro do Facebok diretamente do seu código - Publique status, faça upload de imagens, determine se duas pessoas são amigos, liste os eventos que a pessoa foi convidada, etc
---
class: vintage
# REST
- *Representational State Transfer* - Transferência de Estado de Representação
---
class: vintage, middle, center
# Hein?
---
class: vintage
# REST
- É *o* padrão desejável de *arquitetura da Internet*
- Define uma série de regras que os componentes de um sistema Web 'ideal' devem seguir
- Ao seguir estas regras, o sistema ganha diversas vantagens como simplicidade, escalabilidade,
portabilidade, estabilidade
---
class: vintage
# REST
- Define 5 elementos básicos
1. Recurso
2. Identificador de Recurso
3. Representação
4. Metadados da Representação
5. Dados de Controle
---
class: vintage
# REST
### Recursos e Identificadores de Recurso
- **Qualquer informação nomeável** pode ser considerado um "recurso"
uma imagem, um documento, uma pessoa, um serviço, uma coleção de outros recursos
- O Identificador de Recurso é uma informação - por exemplo um nome - que é **mapeado para o recurso em si**
- Por mais que o Recurso em si possa **mudar ao longo do tempo**, o Identificador **sempre** aponta para ele
---
class: vintage
# REST
### Recursos e Identificadores de Recurso
- **Identificador** - Presidente dos EUA
- **Recurso** - Barack Obama
- Ano que vem, esse Identificador não apontará mais para *Barack Obama* mas
ainda apontará para seja lá quem for o presidente
---
class: vintage
# REST
### Recursos e Identificadores de Recurso
- **Identificador** - Tony Ramos
- **Recurso** - Tony Ramos
- Este Identificador sempre irá mapear para a mesma pessoa
---
class: vintage
# REST
### Recursos e Identificadores de Recurso
- **Identificador** - Países que são membros da União Europeia
- **Recurso** - [França, Alemanha, Itália, Espanha...]
- Este Identificador aponta para uma lista de Recursos. Quando a Inglaterra
completar sua saída da UE, a lista mudará mas o Identificador continuará
apontando para o lugar certo
---
class: vintage
# REST
### Recursos e Identificadores de Recurso
- **Identificador** - [http://ecorp.com/relatorios_financeiros/relatorio_atual](http://ecorp.com/relatorios_financeiros/relatorio_atual)
- **Recurso** - O relatório financeiro do ano atual
- Independente do ano em que estamos, obteremos o relatório corrente
---
class: vintage
# REST
### Recursos e Identificadores de Recurso
- **Identificador** - [http://ecorp.com/relatorios_financeiros/relatorio_2010](http://ecorp.com/relatorios_financeiros/relatorio_2010)
- **Recurso** - O relatório financeiro do ano de 2010
- Sempre obteremos o relatório de 2010
---
class: vintage
# REST
### Recursos e Identificadores de Recurso
- Seja lá quem nomeou o Recurso é responsável por garantir o mapeamento entre o
Identificador e o Recurso em si!
- Falhas neste mapeamento pode levar a inconsistências e a erros, como o famoso
erro **404 Não Encontrado**, onde um Identificador não é mapeado para recurso algum
---
class: vintage
# REST
### Representações de Recursos
- É uma captura do estado atual ou desejado de um Recurso
---
class: vintage
# REST
### Representações de Recursos
- **Identificador** - Logo do Python
-  **Representação**:

![python logo](img/python-logo.png)
---
class: vintage
# REST
### Representações de Recursos
- **Identificador** - Logo do Python em Preto
-  **Representação**:

![python logo black](img/python-logo-black.png)
---
class: vintage
# REST
### Metadados da Representação
- São informações que qualificam a Representação oferecida
- Deve ser apresentado em pares de chaves e valores, como num dicionário
- Podem incluir informações como o formato da representação, o tamanho, sua
validade, etc
---
class: vintage
# REST
### Metadados da Representação
.pull-left[
-  **Representação**:

![python logo](img/python-logo.png)
]
.pull-right[
- **Metadados**:
```python
    'tipo': 'PNG',
    'tamanho': '8.6kB'
```
]
---
class: vintage
# REST
### Metadados da Representação
- Também podemos oferecer dados que permitem ao cliente determinar a 'validade'
daquela representação
- Dessa forma o cliente pode fazer um *caching* local do recurso e possivelmente
economizar recursos computacionais se for pedir pelo mesmo recurso mais de uma vez
---
class: vintage
# REST
### Metadados da Representação
.pull-left[
- **Identificador:** Foto do presidente dos EUA
- **Representação**:

![presidente dos EUA](img/obama.jpg)
]
.pull-right[
- **Metadados**:
```python
    'tipo': 'JPG',
    'tamanho': '13.5kB',
    'validade': '20/01/2017'
```
]
---
class: vintage
# REST
### Metadados da Representação
- O cliente pode guardar a representação até a data especificada e, caso queira
acessar esse recurso novamente, pode determinar se é necessário fazer a chamada
ao servidor mais uma vez ou se pode simplesmente usar a representação armazenada
---
class: vintage, middle, center
# GET &amp; 404
### Verbos e códigos HTTP
---
class: vintage, middle, center
# JSON &amp; YAML
### Comunicação
---
class: vintage, middle, center
# OAUTH &amp; JWT
### Autenticação
---
class: vintage, middle, center
# Blueprint &amp; Swagger
### Documentação
---
class: vintage, middle, center
# Django, Flask &amp; *Pythonicidade*
### Implementação
---
class: vintage, middle, center
# Py.test, doctest &amp; unittest
### Testando seu código
---
class: vintage
## hai
```python
class A(model):
    __init__(self):
        pass

def hello():
    print('Hello, world!')
```
---
class: vintage, middle, center
# Heroku, EC2, EBS, Lambda
### Colocando seu código no ar
---
class: vintage, middle, center
# AB
### Teste de carga

</textarea>
<script src="http://gnab.github.io/remark/downloads/remark-latest.min.js" type="text/javascript"></script>
<script>
  var hljs = remark.highlighter.engine;
</script>
<script src="remark.language.js"></script>
<script>
  var slideshow = remark.create({
      highlightStyle: 'monokai',
      highlightLanguage: 'remark',
      highlightLines: true
    }) ;
</script>
</body>
</html>
